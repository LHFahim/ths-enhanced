<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<BorderPane xmlns="http://javafx.com/javafx/21.0.3" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.fahim.ths.controller.DoctorController">

  <top>
    <HBox spacing="10" alignment="CENTER_RIGHT" BorderPane.alignment="CENTER">
      <Label text="Doctor Portal â€” Diagnosis, Prescriptions, External Booking, PDF Export"
             style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
      <Button text="Start Telehealth" onAction="#startTelehealth"/>
      <Button text="Logout" onAction="#logout"/>
    </HBox>
  </top>

  <center>
    <TableView fx:id="apptTable" prefHeight="250">
      <columns>
        <TableColumn fx:id="idCol"         text="ID"        prefWidth="80"/>
        <TableColumn fx:id="patientCol"    text="Patient"   prefWidth="120"/>
        <TableColumn fx:id="specialistCol" text="Specialist" prefWidth="160"/>
        <TableColumn fx:id="timeCol"       text="Time"      prefWidth="220"/>
        <TableColumn fx:id="locationCol"   text="Location"  prefWidth="160"/>
      </columns>
    </TableView>
  </center>

  <bottom>
    <TabPane>
      <tabs>

        <!-- ================= diagnosis and treatment ================= -->
        <Tab text="Diagnosis &amp; Treatment">
          <GridPane hgap="10" vgap="10">
            <padding><Insets top="10" right="10" bottom="10" left="10"/></padding>

            <Label text="Diagnosis Notes:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
            <TextArea fx:id="diagnosisArea" prefRowCount="3"
                      GridPane.columnIndex="1" GridPane.rowIndex="0"/>

            <Label text="Treatment Plan:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
            <TextArea fx:id="planArea" prefRowCount="3"
                      GridPane.columnIndex="1" GridPane.rowIndex="1"/>

            <HBox spacing="8" GridPane.columnIndex="1" GridPane.rowIndex="2">
              <Button text="Save" onAction="#saveDiagnosis"/>
              <Button text="Export Visit Summary (PDF)" onAction="#exportSummary"/>
            </HBox>
          </GridPane>
        </Tab>

        <!-- ================= prescription ================= -->
        <Tab text="Prescriptions">
          <BorderPane>
            <top>
              <GridPane hgap="10" vgap="8">
                <padding><Insets top="10" right="10" bottom="10" left="10"/></padding>

                <Label text="Add Prescription (Doctor):" style="-fx-font-weight: bold;"
                       GridPane.columnIndex="0" GridPane.rowIndex="0"/>

                <Label text="Patient ID:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                <TextField fx:id="rxPatientIdField" promptText="P001"
                           GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                <Label text="Medicine:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                <TextField fx:id="rxMedField" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                <Label text="Dosage:" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                <TextField fx:id="rxDoseField" GridPane.columnIndex="1" GridPane.rowIndex="3"/>

                <Button text="Add Prescription" onAction="#addPrescription"
                        GridPane.columnIndex="1" GridPane.rowIndex="4"/>
              </GridPane>
            </top>

            <center>
              <TableView fx:id="rxTable" prefHeight="220">
                <columns>
                  <TableColumn fx:id="rxIdCol"       text="ID"        prefWidth="80"/>
                  <TableColumn fx:id="rxPatientCol"  text="Patient"   prefWidth="100"/>
                  <TableColumn fx:id="rxMedCol"      text="Medicine"  prefWidth="160"/>
                  <TableColumn fx:id="rxDoseCol"     text="Dosage"    prefWidth="160"/>
                  <TableColumn fx:id="rxApprovedCol" text="Approved"  prefWidth="100"/>
                </columns>
              </TableView>
            </center>

            <bottom>
              <HBox spacing="10" alignment="CENTER_RIGHT" BorderPane.alignment="CENTER">
                <padding><Insets top="10" right="10" bottom="10" left="10"/></padding>
                <Label text="Pending refill requests are listed above (Approved = No)."/>
                <Button text="Approve Selected" onAction="#approveSelected"/>
                <Button text="Decline Selected" onAction="#declineSelected"/>
              </HBox>
            </bottom>
          </BorderPane>
        </Tab>

        <!-- ================= external booking ================= -->
        <Tab text="Book External Clinic/Hospital">
          <GridPane hgap="10" vgap="10">
            <padding><Insets top="10" right="10" bottom="10" left="10"/></padding>

            <Label text="Patient ID:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
            <TextField fx:id="patientIdField" promptText="P001"
                       GridPane.columnIndex="1" GridPane.rowIndex="0"/>

            <Label text="Hospital/Clinic:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
            <TextField fx:id="facilityField" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

            <Label text="Date:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
            <DatePicker fx:id="datePicker" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

            <Label text="Time:" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
            <HBox spacing="6" GridPane.columnIndex="1" GridPane.rowIndex="3">
              <Spinner fx:id="hourSpinner" prefWidth="80"/>
              <Spinner fx:id="minuteSpinner" prefWidth="80"/>
            </HBox>

            <Label text="Reason:" GridPane.columnIndex="0" GridPane.rowIndex="4"/>
            <TextField fx:id="reasonField" GridPane.columnIndex="1" GridPane.rowIndex="4"/>

            <Button text="Make Booking" onAction="#makeExternalBooking"
                    GridPane.columnIndex="1" GridPane.rowIndex="5"/>
          </GridPane>
        </Tab>

        <!-- ================= messages ================= -->
        <Tab text="Messages" closable="false">
          <content>
            <fx:include source="/fxml/MessagesView.fxml"/>
          </content>
        </Tab>

      </tabs>
    </TabPane>
  </bottom>
</BorderPane>
